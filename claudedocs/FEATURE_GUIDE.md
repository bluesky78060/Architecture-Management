# Architecture Management 기능 설명서

**버전**: 2.0.0
**최종 수정일**: 2025년 10월 21일
**시스템명**: Architecture Management (건설 프로젝트 관리 시스템)

---

## 📋 목차

1. [시스템 개요](#1-시스템-개요)
2. [로그인 및 사용자 관리](#2-로그인-및-사용자-관리)
3. [대시보드](#3-대시보드)
4. [건축주 관리](#4-건축주-관리)
5. [작업 항목 관리](#5-작업-항목-관리)
6. [견적서 관리](#6-견적서-관리)
7. [청구서 관리](#7-청구서-관리)
8. [일정 관리](#8-일정-관리)
9. [회사 정보 관리](#9-회사-정보-관리)
10. [설정](#10-설정)
11. [관리자 기능](#11-관리자-기능)
12. [데이터 보안](#12-데이터-보안)

---

## 1. 시스템 개요

### 1.1 시스템 소개
Architecture Management는 건설 프로젝트를 효율적으로 관리하기 위한 웹 기반 통합 관리 시스템입니다.

**주요 특징**:
- ☁️ 클라우드 기반 (Vercel + Supabase)
- 🔒 사용자별 데이터 완전 격리 (RLS 보안)
- 📱 반응형 디자인 (모바일/태블릿/데스크톱)
- 🌙 다크모드 지원
- 📄 PDF/Excel 내보내기
- 📅 Google Calendar 연동

**기술 스택**:
- **Frontend**: React 18 + TypeScript + Tailwind CSS
- **Backend**: Supabase (PostgreSQL + Auth)
- **Hosting**: Vercel
- **Libraries**: React Query, React Router v6, ExcelJS, jsPDF

![시스템 아키텍처 다이어그램]
_이미지 자리: 시스템 전체 아키텍처 다이어그램_

---

## 2. 로그인 및 사용자 관리

### 2.1 로그인 방식

시스템은 3가지 로그인 방식을 지원합니다:

#### 2.1.1 이메일/비밀번호 로그인
- 직접 계정 생성 및 로그인
- 비밀번호 찾기 기능 지원
- AES-256-GCM 암호화 저장

**사용 방법**:
1. 로그인 페이지에서 "이메일로 로그인" 선택
2. 이메일과 비밀번호 입력
3. "로그인" 버튼 클릭

![이메일 로그인 화면]
_이미지 자리: 이메일/비밀번호 로그인 화면_

#### 2.1.2 Google 소셜 로그인
- Google 계정으로 간편 로그인
- OAuth 2.0 인증
- Google Calendar 연동 가능

**사용 방법**:
1. 로그인 페이지에서 "Google로 계속하기" 버튼 클릭
2. Google 계정 선택 및 권한 승인
3. 자동 로그인 완료

![Google 로그인 화면]
_이미지 자리: Google 소셜 로그인 화면_

#### 2.1.3 Kakao 소셜 로그인
- Kakao 계정으로 간편 로그인
- OAuth 2.0 인증

**사용 방법**:
1. 로그인 페이지에서 "Kakao로 계속하기" 버튼 클릭
2. Kakao 계정 로그인 및 권한 승인
3. 자동 로그인 완료

![Kakao 로그인 화면]
_이미지 자리: Kakao 소셜 로그인 화면_

### 2.2 사용자 승인 시스템

**v2.0.0부터 모든 신규 가입자는 관리자 승인이 필요합니다.**

#### 2.2.1 승인 대기 화면
- 신규 가입 시 자동으로 승인 대기 상태로 전환
- 관리자 승인 전까지 시스템 접근 불가
- 승인 상태 실시간 확인

**표시 내용**:
- 가입 정보 (이메일, 로그인 방식)
- 승인 대기 안내 메시지
- 고객 지원 연락처

![승인 대기 화면]
_이미지 자리: 사용자 승인 대기 화면_

#### 2.2.2 이메일 알림
- 신규 가입자 발생 시 관리자에게 자동 이메일 발송
- Resend API + PostgreSQL Trigger 사용
- 가입자 정보 (이메일, 로그인 방식, 가입일시) 포함

### 2.3 비밀번호 찾기
- 이메일 주소로 비밀번호 재설정 링크 발송
- Supabase Auth 이메일 템플릿 사용

**사용 방법**:
1. 로그인 페이지에서 "비밀번호를 잊으셨나요?" 클릭
2. 가입한 이메일 주소 입력
3. 이메일로 전송된 재설정 링크 클릭
4. 새 비밀번호 설정

![비밀번호 찾기 화면]
_이미지 자리: 비밀번호 찾기 화면_

---

## 3. 대시보드

### 3.1 개요
대시보드는 시스템의 메인 화면으로, 주요 지표와 최근 활동을 한눈에 볼 수 있습니다.

![대시보드 전체 화면]
_이미지 자리: 대시보드 전체 화면_

### 3.2 주요 지표 (KPI Cards)

#### 3.2.1 총 청구 금액
- **표시 내용**: 모든 청구서의 합계 금액
- **단위**: 원 (₩)
- **아이콘**: 💰 (CurrencyDollarIcon)
- **계산 방식**: `SUM(invoices.totalAmount)`

#### 3.2.2 미수금
- **표시 내용**: 미지급 상태 청구서의 합계
- **단위**: 원 (₩)
- **아이콘**: 📋 (DocumentTextIcon)
- **계산 방식**: `SUM(invoices.totalAmount WHERE status = 'UNPAID')`
- **색상**: 주황색 (경고)

#### 3.2.3 완료된 작업
- **표시 내용**: 완료된 작업 항목 개수
- **단위**: 개
- **아이콘**: ✅ (CheckCircleIcon)
- **계산 방식**: `COUNT(work_items WHERE status = 'COMPLETED')`
- **색상**: 녹색 (성공)

#### 3.2.4 진행 중인 프로젝트
- **표시 내용**: 진행 중인 프로젝트 개수
- **단위**: 개
- **아이콘**: 🚧 (WrenchIcon)
- **계산 방식**: 활성 프로젝트 수
- **색상**: 파란색 (진행)

![KPI 카드들]
_이미지 자리: 4개의 KPI 카드 (총 청구 금액, 미수금, 완료된 작업, 진행 중인 프로젝트)_

### 3.3 최근 청구서 목록

**표시 정보**:
- 청구서 번호
- 건축주 이름
- 작업장 이름
- 청구 금액
- 상태 (지급/미지급/부분지급)
- 청구일

**기능**:
- 최신 5개 청구서 표시
- 상태별 색상 구분 (칩 스타일)
- 클릭 시 상세 페이지 이동

![최근 청구서 목록]
_이미지 자리: 대시보드 하단의 최근 청구서 목록_

### 3.4 빠른 작업 버튼
- **새 견적서 작성**: 견적서 페이지로 이동
- **새 청구서 작성**: 청구서 페이지로 이동
- **작업 항목 추가**: 작업 항목 페이지로 이동

---

## 4. 건축주 관리

### 4.1 개요
건축주(고객) 정보를 등록하고 관리하는 기능입니다.

![건축주 관리 화면]
_이미지 자리: 건축주 관리 메인 화면_

### 4.2 건축주 유형

#### 4.2.1 개인 건축주
**필수 정보**:
- 이름
- 전화번호
- 주소

**선택 정보**:
- 휴대전화
- 이메일
- 메모

#### 4.2.2 사업자 건축주
**필수 정보**:
- 상호명
- 대표자명
- 사업자등록번호
- 전화번호
- 주소

**선택 정보**:
- 업태
- 업종
- 계산서 발행 이메일
- 사업장 주소
- 휴대전화
- 메모

![건축주 등록 폼]
_이미지 자리: 개인/사업자 건축주 등록 폼 (탭 구분)_

### 4.3 주요 기능

#### 4.3.1 건축주 추가
1. 상단 "+ 건축주 추가" 버튼 클릭
2. 개인/사업자 탭 선택
3. 필수 정보 입력
4. "저장" 버튼 클릭

**입력 검증**:
- 전화번호 자동 하이픈 삽입 (010-1234-5678)
- 사업자등록번호 형식 검증 (123-45-67890)
- 필수 항목 누락 시 경고 메시지

#### 4.3.2 작업장 관리
- 건축주별 여러 작업장 등록 가능
- 작업장명 + 주소 저장
- 작업장별 프로젝트 진행 가능

**작업장 추가 방법**:
1. 건축주 편집 화면 하단 "작업장 관리" 섹션
2. "+ 작업장 추가" 버튼 클릭
3. 작업장명과 주소 입력
4. "추가" 버튼 클릭

![작업장 관리]
_이미지 자리: 건축주 상세 화면의 작업장 관리 섹션_

#### 4.3.3 프로젝트 관리
- 작업장별 프로젝트 등록
- 프로젝트명 + 시작일/종료일 저장
- 프로젝트 상태 관리 (진행중/완료/보류)

**프로젝트 추가 방법**:
1. 작업장 선택
2. "+ 프로젝트 추가" 버튼 클릭
3. 프로젝트 정보 입력
4. "저장" 버튼 클릭

#### 4.3.4 건축주 편집
1. 목록에서 건축주 선택 (행 클릭)
2. 정보 수정
3. "저장" 버튼 클릭

#### 4.3.5 건축주 삭제
1. 목록에서 건축주 선택
2. "삭제" 버튼 클릭
3. 확인 다이얼로그에서 "확인" 클릭

**주의**: 삭제 시 관련된 견적서, 청구서, 작업 항목도 함께 삭제됩니다.

#### 4.3.6 Excel 가져오기/내보내기

**Excel 가져오기**:
1. "Excel 가져오기" 버튼 클릭
2. Excel 파일 선택 (.xlsx)
3. 템플릿 형식에 맞춰 작성된 파일 업로드
4. 자동 파싱 및 데이터베이스 저장

**지원 형식**:
- 개인: 이름, 전화번호, 휴대전화, 주소, 이메일
- 사업자: 상호명, 대표자명, 사업자등록번호, 전화번호, 주소, 업태, 업종, 계산서이메일, 사업장주소

**Excel 내보내기**:
1. "Excel 내보내기" 버튼 클릭
2. 전체 건축주 목록이 Excel 파일로 다운로드
3. 파일명: `건축주_목록_YYYYMMDD.xlsx`

![Excel 가져오기/내보내기]
_이미지 자리: Excel 가져오기/내보내기 버튼 및 결과 화면_

### 4.4 검색 및 필터링
- **검색**: 이름, 상호명, 전화번호로 검색
- **필터**: 개인/사업자 구분
- **정렬**: 이름순, 등록일순

---

## 5. 작업 항목 관리

### 5.1 개요
프로젝트의 세부 작업 항목을 등록하고 관리하는 기능입니다.

![작업 항목 관리 화면]
_이미지 자리: 작업 항목 관리 메인 화면_

### 5.2 작업 항목 구조

**기본 정보**:
- 작업명
- 건축주
- 작업장
- 프로젝트

**작업 정보**:
- 작업 카테고리 (인건비/자재비/경비/기타)
- 기본 단가
- 수량
- 단위
- 금액 (자동 계산: 기본 단가 × 수량)

**인건비 상세** (카테고리가 인건비인 경우):
- 작업일
- 작업 시간
- 인원
- 일당
- 식대
- 인건비 합계 (자동 계산)

**기타**:
- 상태 (대기/진행중/완료/보류)
- 비고

![작업 항목 등록 폼]
_이미지 자리: 작업 항목 등록 폼 (전체 필드)_

### 5.3 주요 기능

#### 5.3.1 개별 작업 항목 추가
1. "+ 작업 항목 추가" 버튼 클릭
2. 모달 폼에서 정보 입력
3. "저장" 버튼 클릭

**자동 계산**:
- **금액** = 기본 단가 × 수량
- **인건비 합계** = (일당 × 인원) + 식대

**입력 팁**:
- 수량/단가 입력란 포커스 시 자동 전체 선택
- 숫자 입력 시 천 단위 쉼표 자동 삽입

#### 5.3.2 일괄 작업 항목 추가
여러 작업 항목을 한 번에 추가할 수 있는 기능입니다.

**사용 방법**:
1. "일괄 추가" 버튼 클릭
2. 건축주, 작업장, 프로젝트 공통 정보 선택
3. 작업 항목들을 행 단위로 추가
4. 각 행에 작업명, 카테고리, 단가, 수량 등 입력
5. "모두 저장" 버튼 클릭

**장점**:
- 같은 프로젝트의 여러 작업을 빠르게 등록
- Excel처럼 행 단위 입력
- 일괄 저장으로 효율성 향상

![일괄 작업 항목 추가]
_이미지 자리: 일괄 작업 항목 추가 모달 (여러 행 입력)_

#### 5.3.3 작업 항목 수정
1. 목록에서 작업 항목 클릭
2. 수정 모달에서 정보 변경
3. "저장" 버튼 클릭

#### 5.3.4 작업 항목 삭제
1. 목록에서 체크박스로 항목 선택 (여러 개 가능)
2. "선택 삭제" 버튼 클릭
3. 확인 다이얼로그에서 "확인" 클릭

#### 5.3.5 Excel 내보내기
1. "Excel 내보내기" 버튼 클릭
2. 현재 필터된 작업 항목 목록이 Excel로 다운로드
3. 파일명: `작업_항목_YYYYMMDD.xlsx`

**Excel 포함 내용**:
- 모든 작업 항목 정보
- 카테고리별 소계
- 전체 합계

### 5.4 필터링 및 검색

**필터 옵션**:
- 건축주별
- 작업장별
- 프로젝트별
- 카테고리별 (인건비/자재비/경비/기타)
- 상태별 (대기/진행중/완료/보류)
- 날짜 범위

**검색**:
- 작업명, 비고 텍스트 검색

![필터 및 검색]
_이미지 자리: 작업 항목 필터바 및 검색 기능_

### 5.5 통계 카드
화면 상단에 주요 통계 정보 표시:
- **총 작업 항목 수**
- **총 작업 금액** (모든 항목 합계)
- **완료된 작업 수**
- **진행 중인 작업 수**

![통계 카드]
_이미지 자리: 작업 항목 통계 카드 4개_

---

## 6. 견적서 관리

### 6.1 개요
고객에게 제출할 견적서를 작성하고 관리하는 기능입니다.

![견적서 관리 화면]
_이미지 자리: 견적서 관리 메인 화면_

### 6.2 견적서 구조

**헤더 정보**:
- 견적서 번호 (자동 생성: EST-YYYYMMDD-001)
- 건축주
- 작업장
- 프로젝트
- 견적일
- 유효기간
- 상태 (대기/승인/거부)

**견적 항목**:
- 작업 항목 목록 (작업 항목 관리에서 선택)
- 각 항목별 수량, 단가, 금액
- 카테고리별 소계
- 부가세 (10%)
- 총 금액

**비고**:
- 특이사항, 작업 조건 등 자유 텍스트

![견적서 작성 폼]
_이미지 자리: 견적서 작성 화면 (헤더 + 항목 선택 + 미리보기)_

### 6.3 주요 기능

#### 6.3.1 견적서 작성
1. "+ 견적서 작성" 버튼 클릭
2. 건축주, 작업장, 프로젝트 선택
3. 작업 항목 선택 (다중 선택 가능)
4. 견적일, 유효기간 입력
5. 비고 입력 (선택)
6. "저장" 버튼 클릭

**견적 번호 규칙**:
- 형식: `EST-YYYYMMDD-XXX`
- 예시: `EST-20251021-001`
- 같은 날짜 여러 견적서 생성 시 자동 증가

#### 6.3.2 작업 항목 선택
- 체크박스로 다중 선택
- 선택한 항목들이 견적서에 포함
- 실시간 금액 계산 미리보기

![작업 항목 선택]
_이미지 자리: 견적서 작성 시 작업 항목 선택 화면_

#### 6.3.3 견적서 미리보기
- 실제 인쇄될 형태로 미리보기
- 회사 정보 자동 삽입
- 레이아웃 확인

#### 6.3.4 견적서 PDF 내보내기
1. 목록에서 견적서 선택
2. "PDF 다운로드" 버튼 클릭
3. PDF 파일 자동 다운로드

**PDF 포함 내용**:
- 회사 로고 및 정보
- 견적서 번호 및 일자
- 건축주 정보
- 작업 항목 상세 목록
- 카테고리별 소계
- 부가세 및 총 금액
- 비고
- 서명란

![PDF 견적서]
_이미지 자리: PDF로 내보낸 견적서 샘플_

#### 6.3.5 견적서 Excel 내보내기
1. "Excel 내보내기" 버튼 클릭
2. 선택한 견적서가 Excel로 다운로드
3. 파일명: `견적서_EST-YYYYMMDD-XXX.xlsx`

#### 6.3.6 견적서 수정
1. 목록에서 견적서 클릭
2. 정보 수정 (항목 추가/삭제 가능)
3. "저장" 버튼 클릭

**주의**: 승인된 견적서는 수정 불가

#### 6.3.7 견적서 삭제
1. 목록에서 견적서 선택
2. "삭제" 버튼 클릭
3. 확인 다이얼로그에서 "확인" 클릭

### 6.4 상태 관리

**견적서 상태**:
- **대기**: 고객에게 제출 대기 중
- **승인**: 고객이 승인함
- **거부**: 고객이 거부함

**상태 변경**:
1. 견적서 선택
2. 상태 드롭다운에서 변경
3. 자동 저장

![견적서 상태]
_이미지 자리: 견적서 상태 변경 드롭다운_

### 6.5 필터링 및 검색

**필터 옵션**:
- 건축주별
- 작업장별
- 프로젝트별
- 상태별
- 날짜 범위

**검색**:
- 견적서 번호, 건축주명 검색

### 6.6 통계 카드
- **총 견적서 수**
- **총 견적 금액**
- **승인된 견적서 수**
- **대기 중인 견적서 수**

---

## 7. 청구서 관리

### 7.1 개요
고객에게 발행할 청구서를 작성하고 관리하는 기능입니다.

![청구서 관리 화면]
_이미지 자리: 청구서 관리 메인 화면_

### 7.2 청구서 구조

**헤더 정보**:
- 청구서 번호 (자동 생성: INV-YYYYMMDD-001)
- 건축주
- 작업장
- 프로젝트
- 청구일
- 지급 기한
- 상태 (미지급/부분지급/지급완료)

**청구 항목**:
- 작업 항목 목록
- 각 항목별 수량, 단가, 금액
- 카테고리별 소계
- 부가세 (10%)
- 총 청구 금액

**지급 정보**:
- 지급 금액
- 미지급 잔액
- 지급일

**비고**:
- 결제 방법, 특이사항 등

![청구서 작성 폼]
_이미지 자리: 청구서 작성 화면_

### 7.3 주요 기능

#### 7.3.1 청구서 작성
1. "+ 청구서 작성" 버튼 클릭
2. 건축주, 작업장, 프로젝트 선택
3. 작업 항목 선택 (견적서 기반 또는 직접 선택)
4. 청구일, 지급 기한 입력
5. 비고 입력 (선택)
6. "저장" 버튼 클릭

**청구 번호 규칙**:
- 형식: `INV-YYYYMMDD-XXX`
- 예시: `INV-20251021-001`

#### 7.3.2 견적서에서 청구서 생성
1. 견적서 관리에서 승인된 견적서 선택
2. "청구서 생성" 버튼 클릭
3. 견적서 항목이 자동으로 청구서에 복사됨
4. 청구일, 지급 기한 입력
5. "저장" 버튼 클릭

![견적서→청구서 변환]
_이미지 자리: 견적서에서 청구서 생성 과정_

#### 7.3.3 청구서 PDF 내보내기
1. 목록에서 청구서 선택
2. "PDF 다운로드" 버튼 클릭
3. PDF 파일 자동 다운로드

**PDF 포함 내용**:
- 회사 로고 및 정보
- 청구서 번호 및 일자
- 건축주 정보
- 작업 항목 상세 목록
- 카테고리별 소계
- 부가세 및 총 금액
- 지급 정보 (미지급 금액)
- 비고
- **회사 도장** (이미지 또는 텍스트 스탬프)

**도장 시스템**:
- Settings에서 도장 이미지 업로드 가능
- 업로드하지 않은 경우 텍스트 스탬프 자동 표시
- localStorage에 안전하게 저장
- Safari 호환성 완벽 지원

![PDF 청구서]
_이미지 자리: PDF로 내보낸 청구서 샘플 (도장 포함)_

#### 7.3.4 청구서 Excel 내보내기
1. "Excel 내보내기" 버튼 클릭
2. 선택한 청구서가 Excel로 다운로드
3. 파일명: `청구서_INV-YYYYMMDD-XXX.xlsx`

#### 7.3.5 청구서 인쇄
1. 청구서 선택
2. "인쇄" 버튼 클릭
3. 브라우저 인쇄 대화상자 표시
4. 프린터 설정 후 인쇄

**인쇄 최적화**:
- 페이지 나누기 자동 처리
- 여백 최적화
- 컬러/흑백 모두 지원

#### 7.3.6 지급 상태 관리

**부분 지급 기능**:
1. 청구서 선택
2. "부분 지급" 버튼 클릭
3. 지급 금액 입력
4. 지급일 선택
5. "저장" 버튼 클릭

**자동 계산**:
- **미지급 잔액** = 총 청구 금액 - 지급 금액
- 잔액이 0이 되면 자동으로 "지급완료" 상태 전환

![부분 지급]
_이미지 자리: 부분 지급 입력 대화상자_

### 7.4 상태 관리

**청구서 상태**:
- **미지급**: 아직 지급 안 됨
- **부분지급**: 일부만 지급됨 (잔액 존재)
- **지급완료**: 전액 지급 완료

**상태 변경**:
- 지급 금액 입력 시 자동 전환
- 수동 변경도 가능 (드롭다운)

### 7.5 필터링 및 검색

**필터 옵션**:
- 건축주별
- 작업장별
- 프로젝트별
- 상태별
- 날짜 범위 (청구일, 지급일)

**검색**:
- 청구서 번호, 건축주명 검색

### 7.6 통계 카드
- **총 청구서 수**
- **총 청구 금액**
- **총 미수금** (미지급 + 부분지급 잔액)
- **지급 완료 금액**

![청구서 통계]
_이미지 자리: 청구서 통계 카드_

---

## 8. 일정 관리

### 8.1 개요
프로젝트 일정을 달력 형태로 관리하고 Google Calendar와 동기화하는 기능입니다.

![일정 관리 화면]
_이미지 자리: 일정 관리 메인 화면 (월간 달력 뷰)_

### 8.2 주요 기능

#### 8.2.1 일정 추가
1. 달력에서 날짜 클릭 또는 "+ 일정 추가" 버튼
2. 일정 정보 입력:
   - 제목
   - 시작일시
   - 종료일시
   - 위치 (선택)
   - 설명 (선택)
   - 반복 설정 (선택)
3. "저장" 버튼 클릭

**반복 일정 설정**:
- 매일
- 매주 (요일 선택)
- 매월 (일자 선택)
- 매년
- 사용자 정의

![일정 추가 폼]
_이미지 자리: 일정 추가/수정 모달_

#### 8.2.2 일정 수정/삭제
1. 달력에서 일정 클릭
2. 수정 모달에서 정보 변경 또는 "삭제" 버튼 클릭
3. "저장" 또는 "확인" 클릭

#### 8.2.3 달력 뷰 변경
- **월간 뷰**: 한 달 전체 일정 표시 (기본)
- **주간 뷰**: 1주일 시간대별 상세 표시
- **일간 뷰**: 하루 시간대별 상세 표시
- **목록 뷰**: 일정 목록 형태 표시

![달력 뷰 옵션]
_이미지 자리: 월간/주간/일간/목록 뷰 전환 버튼_

#### 8.2.4 일정 충돌 감지
- 같은 시간대 일정 등록 시 자동 경고
- 충돌 일정 목록 표시
- 확인 후 저장 여부 선택

![일정 충돌 경고]
_이미지 자리: 일정 충돌 경고 대화상자_

### 8.3 Google Calendar 연동

#### 8.3.1 Google Calendar 동기화 설정
1. 일정 관리 화면 우측 상단 "Google Calendar 동기화" 버튼 클릭
2. Google 계정 로그인 및 권한 승인
3. 동기화 완료

**동기화 권한**:
- Google Calendar 읽기/쓰기
- OAuth 2.0 인증
- Production 심사 진행 중 (안전한 앱)

![Google 동기화 설정]
_이미지 자리: Google Calendar 동기화 버튼 및 연결 상태_

#### 8.3.2 양방향 동기화
- **Architecture Management → Google**: 시스템에서 추가한 일정이 자동으로 Google Calendar에 생성됨
- **Google → Architecture Management**: Google Calendar에서 추가한 일정이 시스템에 가져와짐

**동기화 주기**:
- 실시간 동기화 (이벤트 발생 시)
- 수동 동기화 (새로고침 버튼)

#### 8.3.3 동기화 상태 확인
- 연결 상태 표시 (연결됨/연결 안 됨)
- 마지막 동기화 시간 표시
- 오류 발생 시 알림

#### 8.3.4 동기화 해제
1. "동기화 해제" 버튼 클릭
2. 확인 다이얼로그에서 "확인" 클릭
3. Google Calendar 연결 끊김

**주의**: 동기화 해제 시 이후 변경사항은 동기화되지 않습니다.

### 8.4 일정 필터링
- 건축주별
- 작업장별
- 프로젝트별
- 일정 유형별

---

## 9. 회사 정보 관리

### 9.1 개요
견적서, 청구서에 표시될 회사 정보를 관리하는 기능입니다.

![회사 정보 관리 화면]
_이미지 자리: 회사 정보 관리 화면_

### 9.2 관리 항목

**기본 정보**:
- 회사명
- 대표자명
- 사업자등록번호
- 전화번호
- 팩스번호
- 이메일

**주소 정보**:
- 우편번호
- 주소
- 상세 주소

**사업 정보**:
- 업태
- 업종

**계좌 정보**:
- 은행명
- 계좌번호
- 예금주

**로고 및 도장**:
- 회사 로고 이미지 업로드
- 회사 도장 이미지 업로드

![회사 정보 폼]
_이미지 자리: 회사 정보 입력 폼_

### 9.3 주요 기능

#### 9.3.1 회사 정보 수정
1. 회사 정보 페이지 접속
2. 정보 수정
3. "저장" 버튼 클릭
4. Supabase에 자동 저장

#### 9.3.2 로고 업로드
1. "로고 업로드" 버튼 클릭
2. 이미지 파일 선택 (.png, .jpg, .svg)
3. 미리보기 확인
4. "저장" 버튼 클릭

**권장 사항**:
- 크기: 최대 500x200px
- 형식: PNG (투명 배경 권장)
- 용량: 500KB 이하

#### 9.3.3 도장 업로드
1. "도장 업로드" 버튼 클릭
2. 도장 이미지 선택
3. 미리보기 확인
4. "저장" 버튼 클릭

**권장 사항**:
- 크기: 200x200px (정사각형)
- 형식: PNG (투명 배경 권장)
- 배경: 투명
- 용량: 200KB 이하

**도장 자동 처리**:
- 업로드 안 한 경우 텍스트 스탬프 자동 표시
- localStorage에 Base64 인코딩 저장
- Safari 호환성 완벽 지원

![도장 업로드]
_이미지 자리: 도장 이미지 업로드 및 미리보기_

### 9.4 정보 활용
- **견적서/청구서 PDF**: 상단에 회사 정보 자동 삽입
- **이메일 발송**: 발신자 정보로 사용
- **계좌 정보**: 청구서 하단에 자동 표시

---

## 10. 설정

### 10.1 개요
사용자 계정 및 시스템 설정을 관리하는 기능입니다.

![설정 화면]
_이미지 자리: 설정 페이지 전체 화면_

### 10.2 계정 설정

#### 10.2.1 이메일 로그인 사용자
**변경 가능 항목**:
- 이름
- 이메일 주소
- 비밀번호

**사용 방법**:
1. 설정 페이지 접속
2. "계정 정보" 섹션에서 수정
3. "저장" 버튼 클릭

**비밀번호 변경**:
1. "비밀번호 변경" 버튼 클릭
2. 현재 비밀번호 입력
3. 새 비밀번호 입력 (확인 포함)
4. "변경" 버튼 클릭

![이메일 계정 설정]
_이미지 자리: 이메일 로그인 사용자 계정 설정 화면_

#### 10.2.2 SNS 로그인 사용자 (Google/Kakao)
**변경 가능 항목**:
- 이름 (표시명)

**변경 불가 항목**:
- 이메일 주소 → Google/Kakao 계정 설정에서 변경
- 비밀번호 → Google/Kakao 계정 설정에서 변경

**안내 메시지**:
- "Google 계정으로 로그인하셨습니다. 이메일 및 비밀번호는 Google 계정 설정에서 변경해주세요."
- "Kakao 계정으로 로그인하셨습니다. 이메일 및 비밀번호는 Kakao 계정 설정에서 변경해주세요."

![SNS 계정 설정]
_이미지 자리: Google/Kakao 로그인 사용자 설정 화면 (안내 메시지 포함)_

### 10.3 테마 설정

#### 10.3.1 다크모드 전환
- 우측 상단 토글 스위치
- 라이트/다크 모드 즉시 전환
- 설정 자동 저장 (localStorage)

![다크모드 토글]
_이미지 자리: 다크모드 토글 스위치 (ON/OFF 상태)_

### 10.4 알림 설정
- 이메일 알림 ON/OFF
- 브라우저 푸시 알림 ON/OFF
- 알림 유형 선택 (견적서 승인, 청구서 지급 등)

### 10.5 데이터 관리

#### 10.5.1 데이터 내보내기
- 전체 데이터를 JSON 형식으로 내보내기
- 백업 용도

**사용 방법**:
1. "데이터 내보내기" 버튼 클릭
2. JSON 파일 자동 다운로드
3. 파일명: `백업_YYYYMMDD_HHMMSS.json`

#### 10.5.2 계정 삭제
1. "계정 삭제" 버튼 클릭
2. 확인 다이얼로그에서 경고 메시지 확인
3. 비밀번호 입력
4. "삭제 확인" 버튼 클릭

**주의**:
- 모든 데이터가 영구 삭제됩니다
- 복구 불가능합니다
- 삭제 전 데이터 내보내기 권장

---

## 11. 관리자 기능

### 11.1 사용자 승인 관리

**접근 방법**:
- 관리자 계정으로 로그인
- 상단 메뉴에서 "관리자" → "사용자 승인" 클릭

![관리자 메뉴]
_이미지 자리: 관리자 전용 메뉴_

### 11.2 승인 대기 사용자 목록

**표시 정보**:
- 이메일
- 로그인 방식 (이메일/Google/Kakao)
- 가입 일시
- 상태 (대기/승인/거부)

![승인 대기 목록]
_이미지 자리: 사용자 승인 관리 화면_

### 11.3 사용자 승인/거부

**승인 방법**:
1. 목록에서 사용자 선택
2. "승인" 버튼 클릭
3. 확인 다이얼로그에서 "확인" 클릭
4. 사용자 상태가 "승인"으로 변경
5. 사용자가 시스템 접근 가능

**거부 방법**:
1. 목록에서 사용자 선택
2. "거부" 버튼 클릭
3. 거부 사유 입력 (선택)
4. "확인" 클릭
5. 사용자 상태가 "거부"로 변경
6. 사용자는 시스템 접근 불가

![승인/거부 대화상자]
_이미지 자리: 사용자 승인/거부 확인 대화상자_

### 11.4 승인 기록 관리

**승인/거부된 사용자 삭제**:
1. 승인 또는 거부 상태의 사용자 선택
2. "기록 삭제" 버튼 클릭
3. 확인 다이얼로그에서 "확인" 클릭
4. 승인 기록이 데이터베이스에서 삭제됨

**주의**:
- 대기 중인 사용자는 삭제 불가
- 승인된 사용자 기록 삭제 시 다시 가입하면 승인 필요
- 거부된 사용자 기록 삭제 시 재가입 가능

![기록 삭제]
_이미지 자리: 승인 기록 삭제 버튼 및 확인 메시지_

### 11.5 이메일 알림 시스템

**자동 발송 조건**:
- 신규 사용자 가입 시 (user_approvals INSERT 시)
- PostgreSQL Trigger + pg_net + Resend API

**이메일 내용**:
- 제목: "[Architecture Management] 새로운 사용자 가입 승인 요청"
- 내용:
  - 사용자 이메일
  - 로그인 방식 (이메일/Google/Kakao)
  - 가입 일시
  - 승인 관리 페이지 링크

**발송 대상**:
- 관리자 이메일: `bluesky78060@gmail.com`

![관리자 이메일]
_이미지 자리: 관리자에게 발송되는 이메일 샘플_

---

## 12. 데이터 보안

### 12.1 사용자별 데이터 격리

**RLS (Row Level Security) 정책**:
- 모든 테이블에 `user_id` 컬럼 추가
- 각 사용자는 자신의 데이터만 조회/수정/삭제 가능
- Supabase PostgreSQL RLS 정책 적용

**적용 테이블**:
- `clients` (건축주)
- `work_items` (작업 항목)
- `estimates` (견적서)
- `invoices` (청구서)
- `company_info` (회사 정보)
- `schedules` (일정)

**보안 수준**:
- 다른 사용자의 데이터 접근 완전 차단
- SQL 인젝션 방지
- XSS 공격 방지

### 12.2 암호화

**비밀번호 암호화**:
- **알고리즘**: AES-256-GCM
- **키 파생**: PBKDF2 (100,000 iterations)
- **Salt**: 랜덤 생성 (사용자별)
- **저장**: Supabase Auth (안전한 해시)

**민감 정보 암호화**:
- 도장 이미지: Base64 인코딩 후 localStorage
- Google OAuth 토큰: Supabase secure storage

### 12.3 자동 마이그레이션

**XOR → AES 마이그레이션**:
- v1.0 → v2.0 업그레이드 시 자동 실행
- 기존 XOR 암호화 데이터를 AES-256-GCM으로 변환
- 사용자 개입 없이 자동 처리

### 12.4 백업 및 복구

**자동 백업**:
- Supabase 자동 백업 (일 1회)
- Point-in-Time Recovery 지원

**수동 백업**:
- 설정 → 데이터 내보내기
- JSON 형식으로 전체 데이터 다운로드

---

## 13. 문제 해결 (FAQ)

### 13.1 로그인 관련

**Q: 비밀번호를 잊어버렸어요.**
A: 로그인 페이지에서 "비밀번호를 잊으셨나요?" 클릭 → 이메일 주소 입력 → 이메일로 재설정 링크 발송

**Q: Google/Kakao 로그인이 안 돼요.**
A: 팝업 차단 해제 확인 → 브라우저 캐시 삭제 → 다시 시도

**Q: 가입 후 로그인이 안 돼요.**
A: 관리자 승인 대기 중일 수 있습니다. 승인 대기 페이지 확인

### 13.2 데이터 관련

**Q: 데이터가 사라졌어요.**
A: 다른 계정으로 로그인했는지 확인 → 데이터는 사용자별 격리됨

**Q: Excel 가져오기가 안 돼요.**
A: 템플릿 형식 확인 → 필수 컬럼 누락 확인 → 파일 형식 (.xlsx) 확인

**Q: PDF 다운로드가 안 돼요.**
A: 팝업 차단 해제 → 브라우저 설정 확인 → 디스크 용량 확인

### 13.3 Google Calendar 연동

**Q: Google Calendar 동기화가 안 돼요.**
A: Google 계정 권한 확인 → 재연결 시도 → "Google에서 확인하지 않은 앱" 경고는 정상 (Production 심사 중)

**Q: 동기화 후 일정이 중복돼요.**
A: 수동으로 중복 일정 삭제 → 동기화 해제 후 재연결

### 13.4 기타

**Q: 다크모드가 저장 안 돼요.**
A: 브라우저 쿠키/localStorage 설정 확인 → 시크릿 모드는 저장 안 됨

**Q: 모바일에서 레이아웃이 깨져요.**
A: 최신 브라우저 사용 권장 (Chrome, Safari) → 화면 회전 시도

---

## 14. 업데이트 내역

### v2.0.0 (2025.10.17)
- ✅ 사용자 승인 시스템 완전 구현
- ✅ Settings 페이지 로그인 타입별 UI 분리
- ✅ 이메일 알림 시스템 (PostgreSQL Trigger + Resend API)
- ✅ 승인 기록 삭제 기능
- ✅ RELEASE_NOTES.md 전체 릴리즈 노트

### v1.1.0 (2025.10.16)
- ✅ 건축주 사업자 정보 필드 추가 (업태, 업종, 계산서 이메일, 사업장 주소)
- ✅ Excel 가져오기 Supabase 저장 로직
- ✅ 사업장 주소 체크박스 로직 수정

### v1.0.0 (2025.10.15)
- ✅ Supabase 완전 마이그레이션
- ✅ 데이터 격리 보안 강화 (RLS)
- ✅ 작업 항목 UI 개선 (일괄 추가, 비고 필드)

### v0.9.0 (2025.10.05)
- ✅ 암호화 시스템 XOR → AES-256-GCM 업그레이드
- ✅ 자동 마이그레이션 시스템

### v0.8.0 (2025.09.30)
- ✅ 청구서 도장 시스템 최적화 (Safari 호환)
- ✅ Playwright MCP 포괄적 테스트
- ✅ 아이콘 시스템 통일

---

## 15. 기술 지원

### 15.1 연락처
- **이메일**: bluesky78060@gmail.com
- **전화**: 010-7137-8720
- **운영 시간**: 평일 09:00 - 18:00

### 15.2 개인정보처리방침
[개인정보처리방침 전문](https://architecture-management.vercel.app/privacy-policy)

### 15.3 이용약관
[이용약관 전문](https://architecture-management.vercel.app/terms-of-service)

---

**문서 작성**: Claude Code
**버전 관리**: Git (https://github.com/bluesky78060/Architecture-Management)
**배포**: Vercel (https://architecture-management.vercel.app)

---

_이 문서는 추후 스크린샷 및 동영상을 추가하여 완성된 사용자 매뉴얼로 업데이트될 예정입니다._
