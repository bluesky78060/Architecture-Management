"use strict";(self.webpackChunkconstruction_management_frontend=self.webpackChunkconstruction_management_frontend||[]).push([[648],{5826:(e,t,a)=>{a.d(t,{n:()=>r.n});var r=a(8026)},8815:(e,t,a)=>{a.d(t,{Xu:()=>d,bJ:()=>l,p5:()=>c});var r=a(6704);const n=()=>new r.Workbook,o=(e,t,a,r)=>{const n=e.addWorksheet(a);if(t.length>0){const e=Object.keys(t[0]);n.addRow(e).eachCell(e=>{e.font={bold:!0},e.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFE0E0E0"}},e.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}}),t.forEach(t=>{const a=e.map(e=>t[e]);n.addRow(a).eachCell(e=>{e.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}})}),Array.isArray(r)&&r.forEach((e,t)=>{n.getColumn(t+1).width=e})}return n},s=async(e,t)=>{const a=await e.xlsx.writeBuffer(),r=new Blob([a],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),n=window.URL.createObjectURL(r),o=document.createElement("a");o.href=n,o.download=t,document.body.appendChild(o),o.click(),document.body.removeChild(o),window.URL.revokeObjectURL(n)},i={clients:async e=>{const t=e.map(e=>{var t,a,r,n,o;return{ID:e.id,"\uc774\ub984":e.name,"\ud734\ub300\ud3f0":null!==(t=e.mobile)&&void 0!==t?t:"","\uc774\uba54\uc77c":null!==(a=e.email)&&void 0!==a?a:"","\uc8fc\uc18c":null!==(r=e.address)&&void 0!==r?r:"","\uc720\ud615":"BUSINESS"===e.type?"\uc0ac\uc5c5\uc790":"\uac1c\uc778","\ucd1d\uccad\uad6c\uc561":"number"===typeof e.totalBilled?e.totalBilled:0,"\ubbf8\uc218\uae08":"number"===typeof e.outstanding?e.outstanding:0,"\ub4f1\ub85d\uc77c":null!==(n=e.createdAt)&&void 0!==n?n:"","\ube44\uace0":null!==(o=e.notes)&&void 0!==o?o:""}}),a=n();o(a,t,"\uac74\ucd95\uc8fc \ubaa9\ub85d",[8,12,15,20,25,8,12,12,12,20]),await s(a,"\uac74\ucd95\uc8fc_\ubaa9\ub85d.xlsx")},workItems:async e=>{const t=e.map(e=>{var t,a,r,n,o,s,i,l,c,d,u,m,w;return{ID:e.id,"\uac74\ucd95\uc8fc":null!==(t=e.clientName)&&void 0!==t?t:"","\uc791\uc5c5\uc7a5":null!==(a=e.workplaceName)&&void 0!==a?a:"","\ud504\ub85c\uc81d\ud2b8":null!==(r=e.projectName)&&void 0!==r?r:"","\ub0b4\uc6a9":e.name,"\uce74\ud14c\uace0\ub9ac":null!==(n=e.category)&&void 0!==n?n:"","\uae30\ubcf8\ub2e8\uac00":"number"===typeof e.defaultPrice?e.defaultPrice:0,"\uc218\ub7c9":"number"===typeof e.quantity?e.quantity:0,"\ub2e8\uc704":null!==(o=e.unit)&&void 0!==o?o:"","\ucd1d\uae08\uc561":(Number.isFinite(Number(e.defaultPrice))?Number(e.defaultPrice):0)*(Number.isFinite(Number(e.quantity))?Number(e.quantity):0),"\uc778\ubd80\uc778\uc6d0":String(null!==(s=e.laborPersons)&&void 0!==s?s:""),"\uc778\ubd80\ub2e8\uac00":String(null!==(i=e.laborUnitRate)&&void 0!==i?i:""),"\uc77c\ubc18\uc778\ubd80\uc778\uc6d0":String(null!==(l=e.laborPersonsGeneral)&&void 0!==l?l:""),"\uc77c\ubc18\uc778\ubd80\ub2e8\uac00":String(null!==(c=e.laborUnitRateGeneral)&&void 0!==c?c:""),"\uc0c1\ud0dc":null!==(d=e.status)&&void 0!==d?d:"","\uc791\uc5c5\uc77c":null!==(u=e.date)&&void 0!==u?u:"","\uc138\ubd80\uc791\uc5c5":null!==(m=e.description)&&void 0!==m?m:"","\ube44\uace0":null!==(w=e.notes)&&void 0!==w?w:""}}),a=n();o(a,t,"\uc791\uc5c5 \ud56d\ubaa9",[8,12,15,15,20,10,12,8,8,12,10,12,12,12,8,12,20,15]),await s(a,"\uc791\uc5c5_\ud56d\ubaa9.xlsx")},invoices:async e=>{const t=e.map(e=>({"\uccad\uad6c\uc11c\ubc88\ud638":e.id,"\uac74\ucd95\uc8fc":e.client,"\ud504\ub85c\uc81d\ud2b8":e.project||"","\uc791\uc5c5\uc7a5\uc8fc\uc18c":e.workplaceAddress||"","\uccad\uad6c\uae08\uc561":e.amount,"\uc0c1\ud0dc":e.status,"\ubc1c\ud589\uc77c":e.date,"\uc791\uc5c5\ud56d\ubaa9\uc218":e.workItems.length})),a=n();o(a,t,"\uccad\uad6c\uc11c \ubaa9\ub85d",[15,12,15,25,12,10,12,10]),await s(a,"\uccad\uad6c\uc11c_\ubaa9\ub85d.xlsx")},estimates:async e=>{const t=e.map(e=>({"\uacac\uc801\uc11c\ubc88\ud638":e.id,"\uac74\ucd95\uc8fc":e.clientName||"","\uc791\uc5c5\uc7a5":e.workplaceName||"","\ud504\ub85c\uc81d\ud2b8":e.projectName||"","\uc81c\ubaa9":e.title,"\ucd1d\uae08\uc561":e.totalAmount,"\uc0c1\ud0dc":e.status,"\ubc1c\ud589\uc77c":e.date||"","\uc791\uc5c5\ud56d\ubaa9\uc218":e.items.length})),a=n();o(a,t,"\uacac\uc801\uc11c \ubaa9\ub85d",[15,12,15,15,20,12,10,12,10]),await s(a,"\uacac\uc801\uc11c_\ubaa9\ub85d.xlsx")},estimateDetail:async e=>{const t=n(),a=[["\uacac\uc801\uc11c\ubc88\ud638",e.id],["\uac74\ucd95\uc8fc",e.clientName||""],["\uc791\uc5c5\uc7a5",e.workplaceName||""],["\ud504\ub85c\uc81d\ud2b8",e.projectName||""],["\uc81c\ubaa9",e.title],["\ubc1c\ud589\uc77c",e.date||""],["\uc720\ud6a8\uae30\ud55c",e.validUntil||""],["\ucd1d\uae08\uc561",e.totalAmount],["\uc0c1\ud0dc",e.status],["\ube44\uace0",e.notes||""]],r=t.addWorksheet("\uacac\uc801\uc11c \uc815\ubcf4");a.forEach(e=>{r.addRow(e)});const i=e.items.map((e,t)=>({"\uc21c\ubc88":t+1,"\uce74\ud14c\uace0\ub9ac":e.category||"","\ub0b4\uc6a9":e.name,"\uc138\ubd80\uc791\uc5c5":e.description||"","\uc218\ub7c9":e.quantity,"\ub2e8\uc704":e.unit||"","\ub2e8\uac00":e.unitPrice,"\uae08\uc561":"number"===typeof e.quantity&&"number"===typeof e.unitPrice?e.quantity*e.unitPrice:0,"\ube44\uace0":e.notes||""}));o(t,i,"\uc791\uc5c5 \ub0b4\uc5ed",[8,12,20,20,8,8,12,12,15]),await s(t,"\uacac\uc801\uc11c_".concat(e.id,".xlsx"))},invoiceDetail:async e=>{const t=n(),a=[["\uccad\uad6c\uc11c\ubc88\ud638",e.id],["\uac74\ucd95\uc8fc",e.client],["\ud504\ub85c\uc81d\ud2b8",e.project||""],["\uc791\uc5c5\uc7a5\uc8fc\uc18c",e.workplaceAddress||""],["\ubc1c\ud589\uc77c",e.date],["\ucd1d\uae08\uc561",e.amount],["\uc0c1\ud0dc",e.status]],r=t.addWorksheet("\uccad\uad6c\uc11c \uc815\ubcf4");a.forEach(e=>{r.addRow(e)});const i=e.workItems.map((e,t)=>({"\uc21c\ubc88":t+1,"\uce74\ud14c\uace0\ub9ac":e.category||"","\ub0b4\uc6a9":e.name,"\uc138\ubd80\uc791\uc5c5":e.description||"","\uc218\ub7c9":e.quantity,"\ub2e8\uc704":e.unit||"","\ub2e8\uac00":e.unitPrice,"\uae08\uc561":e.total,"\uc791\uc5c5\uc77c":e.date||"","\ube44\uace0":e.notes||""}));o(t,i,"\uc791\uc5c5 \ub0b4\uc5ed",[8,12,20,20,8,8,12,12,12,15]),await s(t,"\uccad\uad6c\uc11c_".concat(e.id,".xlsx"))},importFromExcel:{clients:e=>new Promise((t,a)=>{const n=new FileReader;n.onload=async e=>{try{var n;if(null===(n=e.target)||void 0===n||!n.result)throw new Error("\ud30c\uc77c\uc744 \uc77d\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.");const a=new Uint8Array(e.target.result),o=new r.Workbook;await o.xlsx.load(a);const s=o.getWorksheet(1);if(!s)throw new Error("\uc6cc\ud06c\uc2dc\ud2b8\ub97c \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.");const i=[],l=[];s.getRow(1).eachCell(e=>{l.push(e.value)}),s.eachRow((e,t)=>{if(1===t)return;const a={},r=[];e.eachCell(e=>{r.push(e.value)}),l.forEach((e,t)=>{const n=r[t];if(void 0===n||null===n)return;const o=String(n).trim();if(""!==o)switch(e){case"ID":case"\uc774\ub984":a.name=o;break;case"\ud734\ub300\ud3f0":a.mobile=o;break;case"\uc774\uba54\uc77c":a.email=o;break;case"\uc8fc\uc18c":a.address=o;break;case"\uc720\ud615":a.type="\uc0ac\uc5c5\uc790"===o?"BUSINESS":"PERSON";break;case"\ube44\uace0":a.notes=o}}),void 0!==a.name&&""!==a.name&&i.push(a)}),t(i)}catch(o){a(o)}},n.onerror=()=>a(new Error("\ud30c\uc77c \uc77d\uae30 \uc624\ub958")),n.readAsArrayBuffer(e)}),workItems:e=>new Promise((t,a)=>{const n=new FileReader;n.onload=async e=>{try{var n;if(null===(n=e.target)||void 0===n||!n.result)throw new Error("\ud30c\uc77c\uc744 \uc77d\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.");const a=new Uint8Array(e.target.result),o=new r.Workbook;await o.xlsx.load(a);const s=o.getWorksheet(1);if(!s)throw new Error("\uc6cc\ud06c\uc2dc\ud2b8\ub97c \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.");const i=[],l=[];s.getRow(1).eachCell(e=>{l.push(e.value)}),s.eachRow((e,t)=>{if(1===t)return;const a={},r=[];e.eachCell(e=>{r.push(e.value)}),l.forEach((e,t)=>{const n=r[t];if(void 0===n||null===n)return;const o=String(n).trim();if(""!==o)switch(e){case"\ub0b4\uc6a9":a.name=o;break;case"\uac74\ucd95\uc8fc":a.clientName=o;break;case"\uc791\uc5c5\uc7a5":a.workplaceName=o;break;case"\ud504\ub85c\uc81d\ud2b8":a.projectName=o;break;case"\uce74\ud14c\uace0\ub9ac":a.category=o;break;case"\ub2e8\uc704":a.unit=o;break;case"\uae30\ubcf8\ub2e8\uac00":{const e=Number(o);a.defaultPrice=Number.isFinite(e)?e:0}break;case"\uc218\ub7c9":{const e=Number(o);a.quantity=Number.isFinite(e)?e:0}break;case"\uc0c1\ud0dc":a.status=o;break;case"\uc791\uc5c5\uc77c":a.date=o;break;case"\uc138\ubd80\uc791\uc5c5":a.description=o;break;case"\ube44\uace0":a.notes=o}}),a.name&&i.push(a)}),t(i)}catch(o){a(o)}},n.onerror=()=>a(new Error("\ud30c\uc77c \uc77d\uae30 \uc624\ub958")),n.readAsArrayBuffer(e)}),estimates:e=>new Promise((t,a)=>{const n=new FileReader;n.onload=async e=>{try{var n;if(null===(n=e.target)||void 0===n||!n.result)throw new Error("\ud30c\uc77c\uc744 \uc77d\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.");const a=new Uint8Array(e.target.result),o=new r.Workbook;await o.xlsx.load(a);const s=o.getWorksheet(1);if(!s)throw new Error("\uc6cc\ud06c\uc2dc\ud2b8\ub97c \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.");const i=[],l=[];s.getRow(1).eachCell(e=>{l.push(e.value)}),s.eachRow((e,t)=>{if(1===t)return;const a={},r=[];e.eachCell(e=>{r.push(e.value)}),l.forEach((e,t)=>{const n=r[t];if(void 0===n||null===n)return;const o=String(n).trim();if(o)switch(e){case"\uacac\uc801\uc11c\ubc88\ud638":a.id=o;break;case"\uac74\ucd95\uc8fc":a.clientName=o;break;case"\uc791\uc5c5\uc7a5":a.workplaceName=o;break;case"\ud504\ub85c\uc81d\ud2b8":a.projectName=o;break;case"\uc81c\ubaa9":a.title=o;break;case"\ucd1d\uae08\uc561":a.totalAmount=Number(o)||0;break;case"\uc0c1\ud0dc":a.status=o;break;case"\ubc1c\ud589\uc77c":a.date=o}}),a.title&&i.push(a)}),t(i)}catch(o){a(o)}},n.onerror=()=>a(new Error("\ud30c\uc77c \uc77d\uae30 \uc624\ub958")),n.readAsArrayBuffer(e)})},downloadTemplates:{clients:async()=>{const e=n();o(e,[{ID:"","\uc774\ub984":"\ud64d\uae38\ub3d9","\ud734\ub300\ud3f0":"010-1234-5678","\uc774\uba54\uc77c":"hong@example.com","\uc8fc\uc18c":"\uc11c\uc6b8\uc2dc \uac15\ub0a8\uad6c \ud14c\ud5e4\ub780\ub85c 123","\uc720\ud615":"\uac1c\uc778","\ucd1d\uccad\uad6c\uc561":0,"\ubbf8\uc218\uae08":0,"\ub4f1\ub85d\uc77c":"","\ube44\uace0":"\uc0d8\ud50c \uac74\ucd95\uc8fc"}],"\uac74\ucd95\uc8fc \ud15c\ud50c\ub9bf",[8,12,15,20,25,8,12,12,12,20]),await s(e,"\uac74\ucd95\uc8fc_\ud15c\ud50c\ub9bf.xlsx")},workItems:async()=>{const e=n();o(e,[{ID:"","\uac74\ucd95\uc8fc":"\ud64d\uae38\ub3d9","\uc791\uc5c5\uc7a5":"\uc11c\uc6b8 \uc544\ud30c\ud2b8","\ud504\ub85c\uc81d\ud2b8":"\uc695\uc2e4 \ub9ac\ubaa8\ub378\ub9c1","\ub0b4\uc6a9":"\ud0c0\uc77c \uc2dc\uacf5","\uce74\ud14c\uace0\ub9ac":"\ub9c8\uac10\uacf5\uc0ac","\uae30\ubcf8\ub2e8\uac00":5e4,"\uc218\ub7c9":10,"\ub2e8\uc704":"m\xb2","\ucd1d\uae08\uc561":5e5,"\uc778\ubd80\uc778\uc6d0":2,"\uc778\ubd80\ub2e8\uac00":2e5,"\uc77c\ubc18\uc778\ubd80\uc778\uc6d0":1,"\uc77c\ubc18\uc778\ubd80\ub2e8\uac00":15e4,"\uc0c1\ud0dc":"\uc608\uc815","\uc791\uc5c5\uc77c":"","\uc138\ubd80\uc791\uc5c5":"\ubcbd\uba74 \ud0c0\uc77c \uad50\uccb4","\ube44\uace0":"\uc0d8\ud50c \uc791\uc5c5\ud56d\ubaa9"}],"\uc791\uc5c5\ud56d\ubaa9 \ud15c\ud50c\ub9bf",[8,12,15,15,20,10,12,8,8,12,10,12,12,12,8,12,20,15]),await s(e,"\uc791\uc5c5\ud56d\ubaa9_\ud15c\ud50c\ub9bf.xlsx")},estimates:async()=>{const e=n();o(e,[{"\uacac\uc801\uc11c\ubc88\ud638":"EST-2024-001","\uac74\ucd95\uc8fc":"\ud64d\uae38\ub3d9","\uc791\uc5c5\uc7a5":"\uc11c\uc6b8 \uc544\ud30c\ud2b8","\ud504\ub85c\uc81d\ud2b8":"\uc695\uc2e4 \ub9ac\ubaa8\ub378\ub9c1","\uc81c\ubaa9":"\uc695\uc2e4 \ub9ac\ubaa8\ub378\ub9c1 \uacac\uc801\uc11c","\ucd1d\uae08\uc561":1e6,"\uc0c1\ud0dc":"\uac80\ud1a0\uc911","\ubc1c\ud589\uc77c":"2024-01-01","\uc791\uc5c5\ud56d\ubaa9\uc218":5}],"\uacac\uc801\uc11c \ud15c\ud50c\ub9bf",[15,12,15,15,20,12,10,12,10]),await s(e,"\uacac\uc801\uc11c_\ud15c\ud50c\ub9bf.xlsx")},invoices:async()=>{const e=n();o(e,[{"\uccad\uad6c\uc11c\ubc88\ud638":"INV-2024-001","\uac74\ucd95\uc8fc":"\ud64d\uae38\ub3d9","\ud504\ub85c\uc81d\ud2b8":"\uc695\uc2e4 \ub9ac\ubaa8\ub378\ub9c1","\uc791\uc5c5\uc7a5\uc8fc\uc18c":"\uc11c\uc6b8\uc2dc \uac15\ub0a8\uad6c \ud14c\ud5e4\ub780\ub85c 123","\uccad\uad6c\uae08\uc561":1e6,"\uc0c1\ud0dc":"\ubc1c\uc1a1\ub300\uae30","\ubc1c\ud589\uc77c":"2024-01-01","\uc791\uc5c5\ud56d\ubaa9\uc218":5}],"\uccad\uad6c\uc11c \ud15c\ud50c\ub9bf",[15,12,15,25,12,10,12,10]),await s(e,"\uccad\uad6c\uc11c_\ud15c\ud50c\ub9bf.xlsx")}}},l=i,c=i.importFromExcel,d=i.downloadTemplates},9529:(e,t,a)=>{a.d(t,{A:()=>c});var r=a(6601),n=a(9198),o=a(879),s=a(5582);const i=(0,r.FZ)(e=>(0,s.jsx)("div",{className:"pointer-events-none fixed z-[9999]",style:e.v0,role:"tooltip",children:(0,s.jsxs)("div",{className:"relative",style:e.v1,children:[(0,s.jsx)("div",{className:"bg-primary-600 text-white text-sm font-medium py-1.5 px-3 rounded-full shadow-lg whitespace-nowrap",children:e.v2}),(0,s.jsx)("div",{className:"absolute bg-primary-600",style:e.v3})]})}),{name:"JSX_tooltipNode_1",portals:["v2"]}),l=(0,r.FZ)(e=>e.v0,{name:"Tooltip_1",portals:["v0"]}),c=function(e){let{label:t,children:a,position:r="top"}=e;const c=(0,n.useRef)(null),[d,u]=(0,n.useState)(!1),[m,w]=(0,n.useState)({x:0,y:0}),h=(0,n.useCallback)(()=>{const e=c.current;if(null===e)return;const t=e.getBoundingClientRect();switch(r){case"bottom":{const e=2;w({x:t.left+t.width/e,y:t.bottom})}break;case"left":{const e=2;w({x:t.left,y:t.top+t.height/e})}break;case"right":{const e=2;w({x:t.right,y:t.top+t.height/e})}break;default:{const e=2;w({x:t.left+t.width/e,y:t.top})}}},[r]);(0,n.useEffect)(()=>{if(!d)return;h();const e=()=>h(),t=()=>h();return window.addEventListener("scroll",e,!0),window.addEventListener("resize",t),()=>{window.removeEventListener("scroll",e,!0),window.removeEventListener("resize",t)}},[d,h]);const p={};switch(r){case"bottom":p.transform="translate(-50%, ".concat(6,"px)");break;case"left":p.transform="translate(calc(-100% - ".concat(6,"px), -50%)");break;case"right":p.transform="translate(".concat(6,"px, -50%)");break;default:p.transform="translate(-50%, calc(-100% - ".concat(6,"px))")}const b={width:10,height:10};"top"===r?Object.assign(b,{bottom:-5,left:"50%",transform:"translateX(-50%) rotate(45deg)"}):"bottom"===r?Object.assign(b,{top:-5,left:"50%",transform:"translateX(-50%) rotate(45deg)"}):"left"===r?Object.assign(b,{right:-5,top:"50%",transform:"translateY(-50%) rotate(45deg)"}):"right"===r&&Object.assign(b,{left:-5,top:"50%",transform:"translateY(-50%) rotate(45deg)"});const f=d?(0,o.createPortal)((0,s.jsx)(i,{v0:{left:m.x,top:m.y},v1:p,v2:t,v3:b}),document.body):null;return(0,s.jsx)(l,{v0:(0,s.jsxs)("span",{className:"relative inline-flex items-center",ref:c,onMouseEnter:()=>u(!0),onMouseLeave:()=>u(!1),onFocus:()=>u(!0),onBlur:()=>u(!1),children:[a,f]})})}}}]);
//# sourceMappingURL=648.83727047.chunk.js.map