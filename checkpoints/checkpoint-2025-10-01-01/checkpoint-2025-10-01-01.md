# 체크포인트: CHK-2025-10-01-01
- 생성일시: 2025-10-01 11:28
- 프로젝트 경로: /Users/leechanhee/ConstructionManagement-Installer
- 수정된 파일 수: 2

## 1. 요약
- 의도: 작업 항목 키 중복 경고 해결 및 가져오기 데이터의 ID 충돌 방지, 롤백 코덱스 문서화 정리
- 변경 배경: React key 경고 발생(중복 ID), Excel 가져오기 후 ID 충돌 가능성, 체크포인트 운영 규칙을 문서로 확정
- 범위: src/components/WorkItems.js, AGENTS.md
- 위험도: 낮음 (UI 렌더 키/데이터 정합성 개선 및 문서 추가)

## 2. 변경된 파일 목록
| 파일 경로 | 상태 | 설명 |
|-----------|------|------|
| `src/components/WorkItems.js` | 수정 | Excel 가져오기 시 ID 재할당, 테이블 렌더 key 고유화로 경고 제거 |
| `AGENTS.md` | 수정 | "롤백 체크포인트 코덱스" 섹션 추가 및 AGENTS.md 기록/회전 규칙 반영 |

## 3. 핵심 변경 내용
### `src/components/WorkItems.js`
```diff
@@ handleImportFromExcel
-        const importedWorkItems = await importFromExcel.workItems(file);
-        setWorkItems(prev => [...prev, ...importedWorkItems]);
+        const importedWorkItems = await importFromExcel.workItems(file);
+        // ID 충돌 방지: 기존 최대 ID 이후로 재할당
+        setWorkItems(prev => {
+          const currentMax = prev.length ? Math.max(...prev.map(i => Number(i.id) || 0)) : 0;
+          const remapped = importedWorkItems.map((it, idx) => ({
+            ...it,
+            id: currentMax + idx + 1
+          }));
+          return [...prev, ...remapped];
+        });
```

```diff
@@ 테이블 렌더
-            {filteredWorkItems.map((item) => (
-              <tr key={item.id} className="hover:bg-gray-50">
+            {filteredWorkItems.map((item, idx) => (
+              <tr key={`${item.id}-${idx}`} className="hover:bg-gray-50">
```

### `AGENTS.md`
```diff
@@ 하단 추가
## 롤백 체크포인트 코덱스 (Rollback-codex)
... (역할/목표/작업 절차/출력 형식/단순 규칙) 섹션 전체 추가 ...
```

## 4. 복원 방법
- `src/components/WorkItems.js`: 위 diff의 `+` 변경을 되돌리거나, 본 체크포인트 폴더의 사본으로 교체
- `AGENTS.md`: 본 체크포인트의 버전으로 교체하거나, 추가된 섹션 제거

## 5. 테스트 방법
- Excel 가져오기 후 리스트 렌더 시 React 경고(duplicate key)가 발생하지 않는지 확인
- 동일 ID를 가진 데이터가 저장되어 있어도 테이블 렌더가 정상 동작하는지 확인
- AGENTS.md에 롤백 코덱스 섹션이 존재하는지 확인

